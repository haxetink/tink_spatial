package;

import haxe.io.Bytes;
import tink.spatial.Parser;
import tink.s2d.*;
import haxe.Json;

using StringTools;

@:asserts
class EwkbTest {
	public function new() {}

	// @formatter:off
	// 2D
	// @:variant("0101000020e6100000000000000000f87f000000000000f87f", '{"type":"Point","coordinates":[]}', 4326)
	@:variant("0101000020e6100000000000000000f03f0000000000000040", '{"type":"Point","coordinates":[1,2]}', 4326)
	@:variant("0102000020e610000000000000", '{"type":"LineString","coordinates":[]}', 4326)
	@:variant("0102000020e610000002000000000000000000f03f000000000000004000000000000008400000000000001040", '{"type":"LineString","coordinates":[[1,2],[3,4]]}', 4326)
	@:variant("0103000020e610000000000000", '{"type":"Polygon","coordinates":[]}', 4326)
	@:variant("0103000020e61000000100000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f0000000000000040", '{"type":"Polygon","coordinates":[[[1,2],[3,4],[5,6],[1,2]]]}', 4326)
	@:variant("0103000020e61000000200000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e40000000000000304000000000000026400000000000002840", '{"type":"Polygon","coordinates":[[[1,2],[3,4],[5,6],[1,2]],[[11,12],[13,14],[15,16],[11,12]]]}', 4326)
	@:variant("0103000020e61000000300000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e4000000000000030400000000000002640000000000000284004000000000000000000354000000000000036400000000000003740000000000000384000000000000039400000000000003a4000000000000035400000000000003640", '{"type":"Polygon","coordinates":[[[1,2],[3,4],[5,6],[1,2]],[[11,12],[13,14],[15,16],[11,12]],[[21,22],[23,24],[25,26],[21,22]]]}', 4326)
	@:variant("0104000020e610000000000000", '{"type":"MultiPoint","coordinates":[]}', 4326)
	@:variant("0104000020e6100000010000000101000000000000000000f03f0000000000000040", '{"type":"MultiPoint","coordinates":[[1,2]]}', 4326)
	@:variant("0104000020e6100000020000000101000000000000000000f03f0000000000000040010100000000000000000008400000000000001040", '{"type":"MultiPoint","coordinates":[[1,2],[3,4]]}', 4326)
	@:variant("0105000020e610000000000000", '{"type":"MultiLineString","coordinates":[]}', 4326)
	@:variant("0105000020e610000001000000010200000002000000000000000000f03f000000000000004000000000000008400000000000001040", '{"type":"MultiLineString","coordinates":[[[1,2],[3,4]]]}', 4326)
	@:variant("0105000020e610000002000000010200000002000000000000000000f03f000000000000004000000000000008400000000000001040010200000002000000000000000000144000000000000018400000000000001c400000000000002040", '{"type":"MultiLineString","coordinates":[[[1,2],[3,4]],[[5,6],[7,8]]]}', 4326)
	@:variant("0106000020e610000000000000", '{"type":"MultiPolygon","coordinates":[]}', 4326)
	@:variant("0106000020e61000000100000001030000000100000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f0000000000000040", '{"type":"MultiPolygon","coordinates":[[[[1,2],[3,4],[5,6],[1,2]]]]}', 4326)
	@:variant("0106000020e61000000200000001030000000100000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004001030000000300000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e4000000000000030400000000000002640000000000000284004000000000000000000354000000000000036400000000000003740000000000000384000000000000039400000000000003a4000000000000035400000000000003640", '{"type":"MultiPolygon","coordinates":[[[[1,2],[3,4],[5,6],[1,2]]],[[[1,2],[3,4],[5,6],[1,2]],[[11,12],[13,14],[15,16],[11,12]],[[21,22],[23,24],[25,26],[21,22]]]]}', 4326)
	@:variant("0107000020e610000000000000", '{"type":"GeometryCollection","geometries":[]}', 4326)
	@:variant("0107000020e6100000010000000101000000000000000000f03f0000000000000040", '{"type":"GeometryCollection","geometries":[{"type":"Point","coordinates":[1,2]}]}', 4326)
	@:variant("0107000020e6100000020000000101000000000000000000f03f0000000000000040010200000002000000000000000000f03f000000000000004000000000000008400000000000001040", '{"type":"GeometryCollection","geometries":[{"type":"Point","coordinates":[1,2]},{"type":"LineString","coordinates":[[1,2],[3,4]]}]}', 4326)
	@:variant("0107000020e6100000030000000101000000000000000000f03f0000000000000040010200000002000000000000000000f03f00000000000000400000000000000840000000000000104001030000000300000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e4000000000000030400000000000002640000000000000284004000000000000000000354000000000000036400000000000003740000000000000384000000000000039400000000000003a4000000000000035400000000000003640", '{"type":"GeometryCollection","geometries":[{"type":"Point","coordinates":[1,2]},{"type":"LineString","coordinates":[[1,2],[3,4]]},{"type":"Polygon","coordinates":[[[1,2],[3,4],[5,6],[1,2]],[[11,12],[13,14],[15,16],[11,12]],[[21,22],[23,24],[25,26],[21,22]]]}]}', 4326)
	// 3D (Z)
	// @:variant('01e9030020e6100000000000000000f87f000000000000f87f000000000000f87f', '{"type": "Point", "coordinates": []}', 4326)
	@:variant('01e9030020e6100000000000000000f03f00000000000000400000000000000840', '{"type": "Point", "coordinates": [1, 2, 3]}', 4326)
	@:variant('01ea030020e610000000000000', '{"type": "LineString", "coordinates": []}', 4326)
	@:variant('01ea030020e610000002000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040', '{"type": "LineString", "coordinates": [[1, 2, 1], [3, 4, 2]]}', 4326)
	@:variant('01eb030020e610000000000000', '{"type": "Polygon", "coordinates": []}', 4326)
	@:variant('01eb030020e61000000100000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f', '{"type": "Polygon","coordinates": [[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]]]}', 4326)
	@:variant('01eb030020e61000000200000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e4000000000000030400000000000001840000000000000264000000000000028400000000000001040', '{"type": "Polygon","coordinates": [[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]],[[11, 12, 4], [13, 14, 5], [15, 16, 6], [11, 12, 4]]]}', 4326)
	@:variant('01eb030020e61000000300000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e400000000000003040000000000000184000000000000026400000000000002840000000000000104004000000000000000000354000000000000036400000000000001c4000000000000037400000000000003840000000000000204000000000000039400000000000003a400000000000002240000000000000354000000000000036400000000000001c40', '{"type": "Polygon","coordinates": [[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]],[[11, 12, 4], [13, 14, 5], [15, 16, 6], [11, 12, 4]],[[21, 22, 7], [23, 24, 8], [25, 26, 9], [21, 22, 7]]]}', 4326)
	@:variant('01ec030020e610000000000000', '{"type": "MultiPoint", "coordinates": []}', 4326)
	@:variant('01ec030020e61000000100000001e9030000000000000000f03f0000000000000040000000000000f03f', '{"type": "MultiPoint", "coordinates": [[1, 2, 1]]}', 4326)
	@:variant('01ec030020e61000000200000001e9030000000000000000f03f0000000000000040000000000000f03f01e9030000000000000000084000000000000010400000000000000040', '{"type": "MultiPoint", "coordinates": [[1, 2, 1], [3, 4, 2]]}', 4326)
	@:variant('01ed030020e610000000000000', '{"type": "MultiLineString", "coordinates": []}', 4326)
	@:variant('01ed030020e61000000100000001ea03000002000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040', '{"type": "MultiLineString","coordinates": [[[1, 2, 1], [3, 4, 2]]]}', 4326)
	@:variant('01ed030020e61000000200000001ea03000002000000000000000000f03f0000000000000040000000000000f03f00000000000008400000000000001040000000000000004001ea030000020000000000000000001440000000000000184000000000000008400000000000001c4000000000000020400000000000001040', '{"type": "MultiLineString","coordinates": [[[1, 2, 1], [3, 4, 2]], [[5, 6, 3], [7, 8, 4]]]}', 4326)
	@:variant('01ee030020e610000000000000', '{"type": "MultiPolygon", "coordinates": []}', 4326)
	@:variant('01ee030020e61000000100000001eb0300000100000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f', '{"type": "MultiPolygon","coordinates": [[[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]]]]}', 4326)
	@:variant('01ee030020e61000000200000001eb0300000100000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f01eb0300000300000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e400000000000003040000000000000184000000000000026400000000000002840000000000000104004000000000000000000354000000000000036400000000000001c4000000000000037400000000000003840000000000000204000000000000039400000000000003a400000000000002240000000000000354000000000000036400000000000001c40', '{"type": "MultiPolygon","coordinates": [[[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]]],[[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]],[[11, 12, 4], [13, 14, 5], [15, 16, 6], [11, 12, 4]],[[21, 22, 7], [23, 24, 8], [25, 26, 9], [21, 22, 7]]]]}', 4326)
	@:variant('01ef030020e610000000000000', '{"type": "GeometryCollection", "geometries": []}', 4326)
	@:variant('01ef030020e61000000100000001e9030000000000000000f03f0000000000000040000000000000f03f', '{"type": "GeometryCollection","geometries": [{"type": "Point", "coordinates": [1, 2, 1]}]}', 4326)
	@:variant('01ef030020e61000000200000001e9030000000000000000f03f0000000000000040000000000000f03f01ea03000002000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040', '{"type": "GeometryCollection","geometries": [{"type": "Point", "coordinates": [1, 2, 1]},{"type": "LineString", "coordinates": [[1, 2, 1], [3, 4, 2]]}]}', 4326)
	@:variant('01ef030020e61000000300000001e9030000000000000000f03f0000000000000040000000000000f03f01ea03000002000000000000000000f03f0000000000000040000000000000f03f00000000000008400000000000001040000000000000004001eb0300000300000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e400000000000003040000000000000184000000000000026400000000000002840000000000000104004000000000000000000354000000000000036400000000000001c4000000000000037400000000000003840000000000000204000000000000039400000000000003a400000000000002240000000000000354000000000000036400000000000001c40', '{"type": "GeometryCollection","geometries": [{"type": "Point", "coordinates": [1, 2, 1]},{"type": "LineString", "coordinates": [[1, 2, 1], [3, 4, 2]]},{"type": "Polygon","coordinates": [[[1, 2, 1], [3, 4, 2], [5, 6, 3], [1, 2, 1]],[[11, 12, 4], [13, 14, 5], [15, 16, 6], [11, 12, 4]],[[21, 22, 7], [23, 24, 8], [25, 26, 9], [21, 22, 7]]]}]}', 4326)
	// @formatter:on
	public function ewkb2geojson(wkb:String, geojson:String, srid:Int) {
		final e = Parser.ewkb(hex(wkb));
		var parsed:Dynamic = switch e.geometry {
			case S2D(v): v.toGeoJson();
			case S3D(v): v.toGeoJson();
		}
		var geojson = Json.parse(geojson);
		asserts.compare(geojson, parsed);
		asserts.assert(e.srid == srid);
		return asserts.done();
	}

	// @formatter:off
	// 2D
	@:variant('0101000020e6100000000000000000f87f000000000000f87f', 'SRID=4326;POINT EMPTY')
	@:variant('0101000020e6100000000000000000f03f0000000000000040', 'SRID=4326;POINT(1 2)')
	@:variant('0102000020e610000000000000', 'SRID=4326;LINESTRING EMPTY')
	@:variant('0102000020e610000002000000000000000000f03f000000000000004000000000000008400000000000001040', 'SRID=4326;LINESTRING(1 2,3 4)')
	@:variant('0103000020e610000000000000', 'SRID=4326;POLYGON EMPTY')
	@:variant('0103000020e61000000100000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f0000000000000040', 'SRID=4326;POLYGON((1 2,3 4,5 6,1 2))')
	@:variant('0103000020e61000000200000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e40000000000000304000000000000026400000000000002840', 'SRID=4326;POLYGON((1 2,3 4,5 6,1 2),(11 12,13 14,15 16,11 12))')
	@:variant('0103000020e61000000300000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e4000000000000030400000000000002640000000000000284004000000000000000000354000000000000036400000000000003740000000000000384000000000000039400000000000003a4000000000000035400000000000003640', 'SRID=4326;POLYGON((1 2,3 4,5 6,1 2),(11 12,13 14,15 16,11 12),(21 22,23 24,25 26,21 22))')
	@:variant('0104000020e610000000000000', 'SRID=4326;MULTIPOINT EMPTY')
	@:variant('0104000020e6100000010000000101000000000000000000f03f0000000000000040', 'SRID=4326;MULTIPOINT(1 2)')
	@:variant('0104000020e6100000020000000101000000000000000000f03f0000000000000040010100000000000000000008400000000000001040', 'SRID=4326;MULTIPOINT(1 2,3 4)')
	@:variant('0105000020e610000000000000', 'SRID=4326;MULTILINESTRING EMPTY')
	@:variant('0105000020e610000001000000010200000002000000000000000000f03f000000000000004000000000000008400000000000001040', 'SRID=4326;MULTILINESTRING((1 2,3 4))')
	@:variant('0105000020e610000002000000010200000002000000000000000000f03f000000000000004000000000000008400000000000001040010200000002000000000000000000144000000000000018400000000000001c400000000000002040', 'SRID=4326;MULTILINESTRING((1 2,3 4),(5 6,7 8))')
	@:variant('0106000020e610000000000000', 'SRID=4326;MULTIPOLYGON EMPTY')
	@:variant('0106000020e61000000100000001030000000100000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f0000000000000040', 'SRID=4326;MULTIPOLYGON(((1 2,3 4,5 6,1 2)))')
	@:variant('0106000020e61000000200000001030000000100000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004001030000000300000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e4000000000000030400000000000002640000000000000284004000000000000000000354000000000000036400000000000003740000000000000384000000000000039400000000000003a4000000000000035400000000000003640', 'SRID=4326;MULTIPOLYGON(((1 2,3 4,5 6,1 2)),((1 2,3 4,5 6,1 2),(11 12,13 14,15 16,11 12),(21 22,23 24,25 26,21 22)))')
	@:variant('0107000020e610000000000000', 'SRID=4326;GEOMETRYCOLLECTION EMPTY')
	@:variant('0107000020e6100000010000000101000000000000000000f03f0000000000000040', 'SRID=4326;GEOMETRYCOLLECTION(POINT(1 2))')
	@:variant('0107000020e6100000020000000101000000000000000000f03f0000000000000040010200000002000000000000000000f03f000000000000004000000000000008400000000000001040', 'SRID=4326;GEOMETRYCOLLECTION(POINT(1 2),LINESTRING(1 2,3 4))')
	@:variant('0107000020e6100000030000000101000000000000000000f03f0000000000000040010200000002000000000000000000f03f00000000000000400000000000000840000000000000104001030000000300000004000000000000000000f03f00000000000000400000000000000840000000000000104000000000000014400000000000001840000000000000f03f000000000000004004000000000000000000264000000000000028400000000000002a400000000000002c400000000000002e4000000000000030400000000000002640000000000000284004000000000000000000354000000000000036400000000000003740000000000000384000000000000039400000000000003a4000000000000035400000000000003640', 'SRID=4326;GEOMETRYCOLLECTION(POINT(1 2),LINESTRING(1 2,3 4),POLYGON((1 2,3 4,5 6,1 2),(11 12,13 14,15 16,11 12),(21 22,23 24,25 26,21 22)))')
	// 3D (Z)
	@:variant('01e9030020e6100000000000000000f87f000000000000f87f000000000000f87f', 'SRID=4326;POINT Z EMPTY')
	@:variant('01e9030020e6100000000000000000f03f00000000000000400000000000000840', 'SRID=4326;POINT Z (1 2 3)')
	@:variant('01ea030020e610000000000000', 'SRID=4326;LINESTRING Z EMPTY')
	@:variant('01ea030020e610000002000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040', 'SRID=4326;LINESTRING Z (1 2 1,3 4 2)')
	@:variant('01eb030020e610000000000000', 'SRID=4326;POLYGON Z EMPTY')
	@:variant('01eb030020e61000000100000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f', 'SRID=4326;POLYGON Z ((1 2 1,3 4 2,5 6 3,1 2 1))')
	@:variant('01eb030020e61000000200000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e4000000000000030400000000000001840000000000000264000000000000028400000000000001040', 'SRID=4326;POLYGON Z ((1 2 1,3 4 2,5 6 3,1 2 1),(11 12 4,13 14 5,15 16 6,11 12 4))')
	@:variant('01eb030020e61000000300000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e400000000000003040000000000000184000000000000026400000000000002840000000000000104004000000000000000000354000000000000036400000000000001c4000000000000037400000000000003840000000000000204000000000000039400000000000003a400000000000002240000000000000354000000000000036400000000000001c40', 'SRID=4326;POLYGON Z ((1 2 1,3 4 2,5 6 3,1 2 1),(11 12 4,13 14 5,15 16 6,11 12 4),(21 22 7,23 24 8,25 26 9,21 22 7))')
	@:variant('01ec030020e610000000000000', 'SRID=4326;MULTIPOINT Z EMPTY')
	@:variant('01ec030020e61000000100000001e9030000000000000000f03f0000000000000040000000000000f03f', 'SRID=4326;MULTIPOINT Z (1 2 1)')
	@:variant('01ec030020e61000000200000001e9030000000000000000f03f0000000000000040000000000000f03f01e9030000000000000000084000000000000010400000000000000040', 'SRID=4326;MULTIPOINT Z (1 2 1,3 4 2)')
	@:variant('01ed030020e610000000000000', 'SRID=4326;MULTILINESTRING Z EMPTY')
	@:variant('01ed030020e61000000100000001ea03000002000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040', 'SRID=4326;MULTILINESTRING Z ((1 2 1,3 4 2))')
	@:variant('01ed030020e61000000200000001ea03000002000000000000000000f03f0000000000000040000000000000f03f00000000000008400000000000001040000000000000004001ea030000020000000000000000001440000000000000184000000000000008400000000000001c4000000000000020400000000000001040', 'SRID=4326;MULTILINESTRING Z ((1 2 1,3 4 2),(5 6 3,7 8 4))')
	@:variant('01ee030020e610000000000000', 'SRID=4326;MULTIPOLYGON Z EMPTY')
	@:variant('01ee030020e61000000100000001eb0300000100000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f', 'SRID=4326;MULTIPOLYGON Z (((1 2 1,3 4 2,5 6 3,1 2 1)))')
	@:variant('01ee030020e61000000200000001eb0300000100000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f01eb0300000300000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e400000000000003040000000000000184000000000000026400000000000002840000000000000104004000000000000000000354000000000000036400000000000001c4000000000000037400000000000003840000000000000204000000000000039400000000000003a400000000000002240000000000000354000000000000036400000000000001c40', 'SRID=4326;MULTIPOLYGON Z (((1 2 1,3 4 2,5 6 3,1 2 1)),((1 2 1,3 4 2,5 6 3,1 2 1),(11 12 4,13 14 5,15 16 6,11 12 4),(21 22 7,23 24 8,25 26 9,21 22 7)))')
	@:variant('01ef030020e610000000000000', 'SRID=4326;GEOMETRYCOLLECTION Z EMPTY')
	@:variant('01ef030020e61000000100000001e9030000000000000000f03f0000000000000040000000000000f03f', 'SRID=4326;GEOMETRYCOLLECTION Z (POINT Z (1 2 1))')
	@:variant('01ef030020e61000000200000001e9030000000000000000f03f0000000000000040000000000000f03f01ea03000002000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040', 'SRID=4326;GEOMETRYCOLLECTION Z (POINT Z (1 2 1),LINESTRING Z (1 2 1,3 4 2))')
	@:variant('01ef030020e61000000300000001e9030000000000000000f03f0000000000000040000000000000f03f01ea03000002000000000000000000f03f0000000000000040000000000000f03f00000000000008400000000000001040000000000000004001eb0300000300000004000000000000000000f03f0000000000000040000000000000f03f000000000000084000000000000010400000000000000040000000000000144000000000000018400000000000000840000000000000f03f0000000000000040000000000000f03f040000000000000000002640000000000000284000000000000010400000000000002a400000000000002c4000000000000014400000000000002e400000000000003040000000000000184000000000000026400000000000002840000000000000104004000000000000000000354000000000000036400000000000001c4000000000000037400000000000003840000000000000204000000000000039400000000000003a400000000000002240000000000000354000000000000036400000000000001c40', 'SRID=4326;GEOMETRYCOLLECTION Z (POINT Z (1 2 1),LINESTRING Z (1 2 1,3 4 2),POLYGON Z ((1 2 1,3 4 2,5 6 3,1 2 1),(11 12 4,13 14 5,15 16 6,11 12 4),(21 22 7,23 24 8,25 26 9,21 22 7)))')
	// @formatter:on
	public function ewkb2ewkt(ewkb:String, ewkt:String) {
		final e = Parser.ewkb(hex(ewkb));
		
		var serialized = switch e.geometry {
			case S2D(v): v.toEwkt(e.srid);
			case S3D(v): v.toEwkt(e.srid);
		}
		asserts.assert(serialized == ewkt);
		return asserts.done();
	}

	function hex(s:String) {
		s = s.replace(' ', '');
		var len = s.length >> 1;
		var bytes = Bytes.alloc(len);
		for (i in 0...len)
			bytes.set(i, Std.parseInt('0x' + s.substr(i * 2, 2)));
		return bytes;
	}
}
